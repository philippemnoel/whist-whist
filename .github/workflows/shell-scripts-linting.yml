# workflows/shell-scripts-linting.yml
#
# Shell Scripts: Linting
# Lint and enforce good practices for shell scripts.

name: "Shell Scripts: Linting"

on:
    pull_request:
        branches:
            - prod
            - staging
            - dev
        paths:
            - "**/*.sh"
            - ".github/workflows/shell-scripts-linting.yml"
    workflow_dispatch:

jobs:
    shell-scripts-linting-main:
        name: Lint Shell Scripts
        runs-on: ubuntu-20.04

        steps:
            - name: Checkout Git Repository
              uses: actions/checkout@v2

            - name: Run Beautysh to Check Scripts Formatting
              uses: illvart/beautysh-action@latest
              with:
                  args: "**/*.sh --indent-size 4 --check"

            - name: Check that All Bash Scripts Start with "#!/bin/bash"
              run: .github/workflows/helpers/shell-scripts/check-shebang.sh

            - name: Check that All Bash Scripts Contain "set -Eeuo pipefail"
              run: .github/workflows/helpers/shell-scripts/check-pipefail.sh
