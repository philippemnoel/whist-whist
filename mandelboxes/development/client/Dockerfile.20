FROM fractal/base:current-build as fractal-development-client

# Force failure on non-zero exit code for commands with a pipe in them
SHELL ["/bin/bash", "-Eeuo", "pipefail", "-c"]

# Replace startup scripts
RUN rm /usr/share/fractal/run-fractal-server.sh
COPY run-fractal-client.sh /usr/share/fractal/run-fractal-client.sh
RUN chmod +x /usr/share/fractal/run-fractal-client.sh
COPY fractal-main.service /etc/systemd/system
RUN systemctl enable fractal-main
